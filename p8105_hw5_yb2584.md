p8105_hw5_yb2584
================
Yunshen Bai
2023-11-14

``` r
library(tidyverse)
library(rvest)
library(dplyr)
library(tidyr)
```

## Problem 1

First, we read the raw data

``` r
homi=read_csv("./data/homicide-data.csv")
homi|>
  head(10)|>
  knitr::kable()
```

| uid        | reported_date | victim_last  | victim_first | victim_race | victim_age | victim_sex | city        | state |      lat |       lon | disposition           |
|:-----------|--------------:|:-------------|:-------------|:------------|:-----------|:-----------|:------------|:------|---------:|----------:|:----------------------|
| Alb-000001 |      20100504 | GARCIA       | JUAN         | Hispanic    | 78         | Male       | Albuquerque | NM    | 35.09579 | -106.5386 | Closed without arrest |
| Alb-000002 |      20100216 | MONTOYA      | CAMERON      | Hispanic    | 17         | Male       | Albuquerque | NM    | 35.05681 | -106.7153 | Closed by arrest      |
| Alb-000003 |      20100601 | SATTERFIELD  | VIVIANA      | White       | 15         | Female     | Albuquerque | NM    | 35.08609 | -106.6956 | Closed without arrest |
| Alb-000004 |      20100101 | MENDIOLA     | CARLOS       | Hispanic    | 32         | Male       | Albuquerque | NM    | 35.07849 | -106.5561 | Closed by arrest      |
| Alb-000005 |      20100102 | MULA         | VIVIAN       | White       | 72         | Female     | Albuquerque | NM    | 35.13036 | -106.5810 | Closed without arrest |
| Alb-000006 |      20100126 | BOOK         | GERALDINE    | White       | 91         | Female     | Albuquerque | NM    | 35.15111 | -106.5378 | Open/No arrest        |
| Alb-000007 |      20100127 | MALDONADO    | DAVID        | Hispanic    | 52         | Male       | Albuquerque | NM    | 35.11178 | -106.7126 | Closed by arrest      |
| Alb-000008 |      20100127 | MALDONADO    | CONNIE       | Hispanic    | 52         | Female     | Albuquerque | NM    | 35.11178 | -106.7126 | Closed by arrest      |
| Alb-000009 |      20100130 | MARTIN-LEYVA | GUSTAVO      | White       | 56         | Male       | Albuquerque | NM    | 35.07538 | -106.5535 | Open/No arrest        |
| Alb-000010 |      20100210 | HERRERA      | ISRAEL       | Hispanic    | 43         | Male       | Albuquerque | NM    | 35.06593 | -106.5723 | Open/No arrest        |

Create a `city_state` variable

``` r
homi=
  homi|>
  mutate(city_state=paste(city,state, sep = ",", collapse = NULL))
homi|>
  head(10)|>
  knitr::kable()
```

| uid        | reported_date | victim_last  | victim_first | victim_race | victim_age | victim_sex | city        | state |      lat |       lon | disposition           | city_state     |
|:-----------|--------------:|:-------------|:-------------|:------------|:-----------|:-----------|:------------|:------|---------:|----------:|:----------------------|:---------------|
| Alb-000001 |      20100504 | GARCIA       | JUAN         | Hispanic    | 78         | Male       | Albuquerque | NM    | 35.09579 | -106.5386 | Closed without arrest | Albuquerque,NM |
| Alb-000002 |      20100216 | MONTOYA      | CAMERON      | Hispanic    | 17         | Male       | Albuquerque | NM    | 35.05681 | -106.7153 | Closed by arrest      | Albuquerque,NM |
| Alb-000003 |      20100601 | SATTERFIELD  | VIVIANA      | White       | 15         | Female     | Albuquerque | NM    | 35.08609 | -106.6956 | Closed without arrest | Albuquerque,NM |
| Alb-000004 |      20100101 | MENDIOLA     | CARLOS       | Hispanic    | 32         | Male       | Albuquerque | NM    | 35.07849 | -106.5561 | Closed by arrest      | Albuquerque,NM |
| Alb-000005 |      20100102 | MULA         | VIVIAN       | White       | 72         | Female     | Albuquerque | NM    | 35.13036 | -106.5810 | Closed without arrest | Albuquerque,NM |
| Alb-000006 |      20100126 | BOOK         | GERALDINE    | White       | 91         | Female     | Albuquerque | NM    | 35.15111 | -106.5378 | Open/No arrest        | Albuquerque,NM |
| Alb-000007 |      20100127 | MALDONADO    | DAVID        | Hispanic    | 52         | Male       | Albuquerque | NM    | 35.11178 | -106.7126 | Closed by arrest      | Albuquerque,NM |
| Alb-000008 |      20100127 | MALDONADO    | CONNIE       | Hispanic    | 52         | Female     | Albuquerque | NM    | 35.11178 | -106.7126 | Closed by arrest      | Albuquerque,NM |
| Alb-000009 |      20100130 | MARTIN-LEYVA | GUSTAVO      | White       | 56         | Male       | Albuquerque | NM    | 35.07538 | -106.5535 | Open/No arrest        | Albuquerque,NM |
| Alb-000010 |      20100210 | HERRERA      | ISRAEL       | Hispanic    | 43         | Male       | Albuquerque | NM    | 35.06593 | -106.5723 | Open/No arrest        | Albuquerque,NM |

The total number of homicides and the number of unsolved homicides are

``` r
homi|>
  group_by(city,disposition)|>
  summarise(n=n())|>
  pivot_wider(names_from = disposition,values_from = n)|>
  janitor::clean_names()|>
  mutate_if(function(x) any(is.na(x)),
    funs(replace_na),
    replace = 0)|>
  mutate(homicides=closed_by_arrest+closed_without_arrest+open_no_arrest,
         unsolved_homicides=closed_without_arrest+open_no_arrest)|>
  select(city,homicides,unsolved_homicides)|>
  knitr::kable()
```

    ## Warning: `funs()` was deprecated in dplyr 0.8.0.
    ## i Please use a list of either functions or lambdas:
    ## 
    ## # Simple named list: list(mean = mean, median = median)
    ## 
    ## # Auto named with `tibble::lst()`: tibble::lst(mean, median)
    ## 
    ## # Using lambdas list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
    ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was
    ## generated.

| city           | homicides | unsolved_homicides |
|:---------------|----------:|-------------------:|
| Albuquerque    |       378 |                146 |
| Atlanta        |       973 |                373 |
| Baltimore      |      2827 |               1825 |
| Baton Rouge    |       424 |                196 |
| Birmingham     |       800 |                347 |
| Boston         |       614 |                310 |
| Buffalo        |       521 |                319 |
| Charlotte      |       687 |                206 |
| Chicago        |      5535 |               4073 |
| Cincinnati     |       694 |                309 |
| Columbus       |      1084 |                575 |
| Dallas         |      1567 |                754 |
| Denver         |       312 |                169 |
| Detroit        |      2519 |               1482 |
| Durham         |       276 |                101 |
| Fort Worth     |       549 |                255 |
| Fresno         |       487 |                169 |
| Houston        |      2942 |               1493 |
| Indianapolis   |      1322 |                594 |
| Jacksonville   |      1168 |                597 |
| Kansas City    |      1190 |                486 |
| Las Vegas      |      1381 |                572 |
| Long Beach     |       378 |                156 |
| Los Angeles    |      2257 |               1106 |
| Louisville     |       576 |                261 |
| Memphis        |      1514 |                483 |
| Miami          |       744 |                450 |
| Milwaukee      |      1115 |                403 |
| Minneapolis    |       366 |                187 |
| Nashville      |       767 |                278 |
| New Orleans    |      1434 |                930 |
| New York       |       627 |                243 |
| Oakland        |       947 |                508 |
| Oklahoma City  |       672 |                326 |
| Omaha          |       409 |                169 |
| Philadelphia   |      3037 |               1360 |
| Phoenix        |       914 |                504 |
| Pittsburgh     |       631 |                337 |
| Richmond       |       429 |                113 |
| Sacramento     |       376 |                139 |
| San Antonio    |       833 |                357 |
| San Bernardino |       275 |                170 |
| San Diego      |       461 |                175 |
| San Francisco  |       663 |                336 |
| Savannah       |       246 |                115 |
| St.Â Louis      |      1677 |                905 |
| Stockton       |       444 |                266 |
| Tampa          |       208 |                 95 |
| Tulsa          |       584 |                193 |
| Washington     |      1345 |                589 |
